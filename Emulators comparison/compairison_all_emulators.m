% Script MATLAB : comparaison des 3 courbes + points expérimentaux
clear; clc; close all

%% 1) Affichage des trois courbes + points expérimentaux
figure('Color','w','Position',[100 100 900 500]);
hold on; grid on;

% % Émulateur complet
% V_complet = [
%     0
%     13.13;
%     18.31;
%     20.56;
%     21.88;
%     22.68;
%     23.52;
%     24.61;
%     25.46;
%     26.1;
%     26.69;
%     27.24;
%     27.52;
%     27.75;
%     28.18;
% 
%    ];
% 
% I_complet = [
%     4.12;
%     4.03;
%     3.96;
%     3.87;
%     3.72;
%     3.63;
%     3.38;
%     3;
%     2.7;
%     2.19;
%     1.72;
%     0.99;
%     0.59;
%     0.26;
%     0;
% ];

% % Émulateur complet - KC85TS
% V_complete = [
%     0
%     13.20;
%     14.49;
%     15.37;
%     16.52;
%     17.29;
%     18.48;
%     19.51;
%     20.11;
%     20.73;
%     21.23;
%     21.55
%     21.7
% ];
% 
% I_complete = [
%     5.34
%     5.33;
%     5.31;
%     5.28;
%     5.15;
%     5.04;
%     4.29;
%     3.60;
%     2.77;
%     1.85;
%     0.89;
%     0.29
%     0
% ];

% Émulateur complet - Uni‑Solar ES‑62T (S = 1000 W/m^2 et T = 25°C)
V_complete = [
    0
    11.90;
    12.39;
    13.38;
    14.47;
    15.04;
    16.60;
    18.09;
    18.88;
    19.93;
    20.58;
    21;
];

I_complete = [
    5.1;
    4.62;
    4.56;
    4.44;
    4.21;
    4.08;
    3.38;
    2.68;
    2.09;
    1.15;
    0.46;
    0;
];



h1 = plot(V_complete,  I_complete,   '-b',  'LineWidth',2);     
% % Émulateur simple 
% V_simple = [
%     0
%     15.59;
%     17.23;
%     18.55;
%     19.60;
%     20.42;
%     21.61;
%     22.88;
%     24.18;
%     25.40;
%     26.10;
%     26.69;
%     27.49;
%     27.97
%     28.18;
% ];
% 
% I_simple = [
%     4.12;
%     4.08;
%     4.06;
%     4.03;
%     3.98;
%     3.94;
%     3.80;
%     3.63;
%     3.18;
%     2.76;
%     2.27;
%     1.84;
%     0.87;
%     0.26;
%     0;
% ];

% % Émulateur simple - KC85TS
% V_simple = [
%     0
%     13.24;
%     14.25;
%     15.19;
%     15.95;
%     17.23;
%     18.29;
%     19.49;
%     20.09;
%     20.62;
%     21.11;
%     21.58
%     21.7
% ];
% 
% I_simple = [
%     5.34
%     5.31;
%     5.29;
%     5.26;
%     5.20;
%     5.04;
%     4.61;
%     4.06;
%     3.36;
%     2.71;
%     1.48;
%     0.29
%     0
% ];

% Émulateur simple -Uni‑Solar ES‑62T (S = 1000 W/m^2 et T = 25°C)
V_simple = [
    0;
    10.14;
    11.60;
    12.88;
    14.14;
    14.96;
    16.69;
    17.92;
    18.90;
    19.91;
    20.49;
    21;
];

I_simple = [
    5.1;
    4.81;
    4.69;
    4.53;
    4.29;
    4.11;
    3.39;
    2.87;
    2.22;
    1.31;
    0.61;
    0;
];


h2 = plot(V_simple, I_simple, '-r', 'LineWidth',2);  % plot modèle exponentielle simple

% % Émulateur commercial
% V_commercial = [
%     0;
%     1.43;
%     4.82;
%     9.5;
%     15.9;
%     18.72;
%     19.9;
%     20.51;
%     22.06;
%     23.07;
%     23.95;
%     24.58;
%     24.79;
%     25.39;
%     25.90;
%     26.43;
%     27.00;
%     27.57;
%     28.09;
%     28.18;
%    ];
% 
% I_commercial = [
%     4.12;
%     4.11;
%     4.09;
%     4.05;
%     3.97;
%     3.89;
%     3.85;
%     3.83;
%     3.73;
%     3.61;
%     3.37;
%     2.96;
%     2.79;
%     2.3;
%     1.87;
%     1.44;
%     0.97;
%     0.5;
%     0.07;
%     0;
% 
% ];

% Émulateur commercial - Uni‑Solar ES‑62T (S = 1000 W/m^2 et T = 25°C)
V_commercial = [
    0;
    3.05;
    5.95;
    7.42;
    10.72;
    11.25;
    12.2;
    12.93;
    13.54;
    14.22;
    14.28;
    14.6;
    14.9;
    15.08;
    15.31;
    15.63;
    15.84;
    16.05;
    16.26;
    16.46;
    16.71;
    17.02;
    17.31;
    17.54;
    17.7;
    18;
    18.54;
    19.01;
    19.56;
    20.02;
    20.5;
    20.94;
    21;
];

I_commercial = [
    5.1;
    5.00;
    4.90;
    4.83;
    4.62;
    4.64;
    4.49;
    4.40;
    4.32;
    4.22;
    4.21;
    4.18;
    4.10;
    4.06;
    4.02;
    3.95;
    3.88;
    3.81;
    3.75;
    3.69;
    3.58;
    3.44;
    3.29;
    3.16;
    3.049;
    2.85;
    2.45;
    2.08;
    1.63;
    1.26;
    0.85;
    0.05;
    0;
];


h3 = plot(V_commercial, I_commercial, '-m', 'LineWidth', 2);  % plot émulateur commercial

% % Données panneau réel
% tension_orig = [
%     4.440892098500626e-16;
%     2.748058671268336;
%     4.726056945642801;
%     6.688955996548755;
%     8.531061259706648;
%     10.388265746333053;
%     12.215271786022441;
%     14.057377049180333;
%     15.89948231233823;
%     17.726488352027623;
%     19.432700603968943;
%     21.25970664365834;
%     22.81492666091458;
%     24.21915444348578;
%     25.351596203623835;
%     26.197152717860224;
%     26.77092320966351;
%     27.32959447799829;
%     27.722174288179477;
%     28.175150992234713
% ];
% 
% courant_orig = [
%     4.124478442280946;
%     4.118219749652294;
%     4.118219749652295;
%     4.124478442280946;
%     4.118219749652294;
%     4.118219749652294;
%     4.055632823365785;
%     4.055632823365784;
%     3.9993045897079256;
%     3.9993045897079265;
%     3.9993045897079256;
%     3.880389429763558;
%     3.6488178025034763;
%     3.235744089012516;
%     2.7162726008344906;
%     2.1842837273991638;
%     1.6648122392211393;
%     1.0764951321279526;
%     0.4819193324061164;
%     0.006258692628648532
% ];

% % Données panneau réel - KC85TS
% 
% V_pannel = [
%     0.022348;
%     2.805293;
%     5.094829;
%     6.772498;
%     8.805455;
%     10.463411;
%     12.397684;
%     14.430690;
%     15.378120;
%     16.029497;
%     16.384810;
%     16.661175;
%     16.878341;
%     17.075832;
%     17.253636;
%     17.470986;
%     17.629138;
%     17.886134;
%     18.103669;
%     18.341001;
%     18.736670;
%     18.875183;
%     19.112663;
%     19.271036;
%     19.429519;
%     19.607825;
%     19.805966;
%     20.004082;
%     20.261777;
%     20.400719;
%     20.777558;
%     21.115022;
%     21.333500;
%     21.472663;
%     21.611790
% ];
% 
% I_pannel = [
%     5.206208;
%     5.190956;
%     5.172038;
%     5.160649;
%     5.141763;
%     5.122924;
%     5.104050;
%     5.070257;
%     5.051506;
%     5.032791;
%     5.017840;
%     5.002899;
%     4.984239;
%     4.946947;
%     4.894751;
%     4.820190;
%     4.741909;
%     4.615169;
%     4.484708;
%     4.335610;
%     4.052331;
%     3.944239;
%     3.750421;
%     3.605059;
%     3.426158;
%     3.221167;
%     2.986360;
%     2.759006;
%     2.419843;
%     2.181317;
%     1.622264;
%     1.033402;
%     0.615983;
%     0.310376;
%     0.015949
% ];

% Données panneau réel - Uni‑Solar ES‑62T (S = 1000 W/m^2 et T = 25°C)
V_pannel = [
    0.02882096069869089;
    0.8934497816593896;
    1.9021834061135388;
    2.786026200873363;
    3.881222707423584;
    5.0340611353711795;
    6.052401746724891;
    7.041921397379914;
    7.9930131004366824;
    9.14585152838428;
    10.231441048034936;
    11.211353711790395;
    11.845414847161571;
    12.546724890829696;
    13.103930131004367;
    13.584279475982532;
    14.083842794759827;
    14.535371179039304;
    14.929257641921398;
    15.265502183406111;
    15.668995633187771;
    16.034061135371175;
    16.379912663755455;
    16.764192139737993;
    17.177292576419212;
    17.619213973799127;
    18.137991266375543;
    18.656768558951967;
    19.09868995633188;
    19.636681222707423;
    20.165065502183403;
    20.57816593886463;
    20.943231441048034
];

I_pannel = [
    5.0629729729729736;
    5.027837837837839;
    4.98918918918919;
    4.954054054054055;
    4.908378378378379;
    4.862702702702704;
    4.8205405405405415;
    4.781891891891893;
    4.72918918918919;
    4.672972972972974;
    4.616756756756757;
    4.567567567567568;
    4.532432432432433;
    4.4972972972972975;
    4.448108108108109;
    4.391891891891893;
    4.32864864864865;
    4.247837837837839;
    4.152972972972973;
    4.058108108108109;
    3.921081081081082;
    3.7735135135135143;
    3.5978378378378384;
    3.3940540540540547;
    3.1270270270270273;
    2.8459459459459464;
    2.4629729729729735;
    2.0483783783783784;
    1.6724324324324327;
    1.191081081081081;
    0.7378378378378381;
    0.3478378378378384;
    0.007027027027026733
];

h4 = plot(V_pannel, I_pannel, 'ko', ...      % plot données panneau réel
          'MarkerSize',6, 'MarkerFaceColor','k');

xlabel('Tension (V)', 'FontSize', 30);
ylabel('Courant (A)', 'FontSize', 30); 
legend([h1 h2 h3 h4], ...
       {'Émulateur open-source modèle à une diode', 'Émulateur open-source modèle exp. simplifié', 'Émulateur commercial', 'Données panneau réel'}, ...
       'Location','best');

% Configurations de police pour les graduations des axes
set(gca, 'FontSize', 30); % Adjusted font size based on your image


% Apply Times New Roman font to all text elements
set(findall(gcf, '-property','FontName'),'FontName','Times New Roman');
set(findall(gca, '-property','FontName'),'FontName','Times New Roman');

hold off; % Relâcher le tracé