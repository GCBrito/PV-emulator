% MATLAB Script: comparison of the 3 curves + experimental points
clear; clc; close all

%% 1) Plotting the three curves + experimental points

figure('Color','w','Position',[100 100 900 500]);
hold on; grid on;

% Complete emulator - ME Solar MESM-50W (S = 1000 W/m^2 and T = 25°C)
% V_single_diode = [
%     0;
%     6.993855;
%     10.947917;
%     14.322508;
%     15.97874;
%     17.005857;
%     17.847771;
%     18.351051;
%     19.306019;
%     20.117302;
%     20.741932;
%     21.237494;
%     21.773888;
%     22.3;
% ];
% 
% I_single_diode = [
%     3.03;
%     3.027369;
%     3.02415;
%     3.009032;
%     2.969837;
%     2.880805;
%     2.793502;
%     2.621022;
%     2.293747;
%     1.991315;
%     1.521222;
%     1.131808;
%     0.559949;
%     0;
% ];

% Complete emulator - Renogy RNG-50DB-H (S = 1000 W/m^2 and T = 25°C)
V_single_diode = [
    0;
    7.320326;
    11.047176;
    14.633799;
    16.772703;
    18.451015;
    19.458088;
    20.484665;
    21.060669;
    21.505325;
    22.052029;
    22.6;
];
I_single_diode = [
    2.92;
    2.915389;
    2.912366;
    2.899004;
    2.849638;
    2.713782;
    2.405523;
    2.079475;
    1.663485;
    1.332226;
    0.665934;
    0;
];

h1 = plot(V_single_diode,  I_single_diode,   '-b',  'LineWidth',2);     

% % Simple emulator - ME Solar MESM-50W (S = 1000 W/m^2 and T = 25°C)
% V_simplified_exp = [
%     0;
%     8.08962;
%     11.45164;
%     14.526568;
%     16.046844;
%     16.94203;
%     17.753181;
%     18.2904;
%     19.387537;
%     20.072838;
%     20.594084;
%     21.106194;
%     21.724693;
%     22.3;
% ];
% 
% I_simplified_exp = [
%     3.03;
%     3.028738;
%     3.021295;
%     2.99427;
%     2.949897;
%     2.878464;
%     2.813736;
%     2.679999;
%     2.389157;
%     2.202046;
%     1.848619;
%     1.501389;
%     0.7471;
%     0;
% ];

% Simple emulator - Renogy RNG-50DB-H – 50 W (S = 1000 W/m^2 and T = 25°C)
V_simplified_exp = [
    0;
    6.817072;
    11.080575;
    15.057276;
    16.803661;
    17.610468;
    18.552885;
    19.459518;
    20.528112;
    21.02478;
    21.487143;
    22.002245;
    22.6;
];
I_simplified_exp = [
    2.92;
    2.919855;
    2.918193;
    2.894286;
    2.843843;
    2.780185;
    2.695215;
    2.44177;
    2.114295;
    1.793764;
    1.483582;
    0.796883;
    0;
];

h2 = plot(V_simplified_exp, I_simplified_exp, '-r', 'LineWidth',2);  % plot simple exponential model

% % Commercial emulator - ME Solar MESM-50W – 50 W (S = 1000 W/m^2 and T = 25°C)
% V_commercial = [
%     0.978;
%     2.693;
%     4.348;
%     5.35;
%     7.66;
%     8.37;
%     9.39;
%     11.58;
%     12.91;
%     13.86;
%     15.93;
%     16.26;
%     17.38;
%     18.86;
%     19.6;
%     19.92;
%     20.31;
%     20.62;
%     21.04;
%     21.2;
%     21.47;
%     21.78;
%     21.96;
%     22.18;
%     22.33;
%     22.42;
%     22.73;
% ];
% 
% I_commercial = [
%     3.024;
%     3.018;
%     3.012;
%     3.007;
%     2.995;
%     2.99;
%     2.983;
%     2.965;
%     2.95;
%     2.937;
%     2.896;
%     2.887;
%     2.843;
%     2.662;
%     2.243;
%     2.026;
%     1.764;
%     1.55;
%     1.27;
%     1.156;
%     0.971;
%     0.764;
%     0.648;
%     0.496;
%     0.392;
%     0.333;
%     0.129;
% ];

% Commercial emulator - Renogy RNG-50DB-H – 50 W (S = 1000 W/m^2 and T = 25°C)
V_commercial = [
    0.501;
    1.23;
    2.7;
    3.14;
    4.63;
    5.6;
    6.1;
    7.6;
    8.7;
    9.3;
    10.81;
    11.26;
    12.34;
    13.1;
    14.7;
    15.65;
    15.81;
    16.32;
    16.47;
    16.81;
    16.96;
    17.36;
    17.68;
    17.73;
    17.91;
    18.24;
    18.37;
    18.63;
    18.88;
    18.97;
    19.12;
    19.4;
    19.52;
    19.68;
    19.78;
    19.84;
    20.05;
    20.24;
    20.44;
    20.65;
    20.82;
    21.08;
    21.18;
    21.41;
    21.6;
    21.8;
    22.05;
    22.21;
    22.43;
    22.62;
    22.8;
    23.0;
    23.15;
];
I_commercial = [
    2.92;
    2.92;
    2.91;
    2.91;
    2.9;
    2.9;
    2.9;
    2.89;
    2.88;
    2.88;
    2.87;
    2.87;
    2.86;
    2.85;
    2.83;
    2.82;
    2.81;
    2.804;
    2.801;
    2.793;
    2.789;
    2.776;
    2.766;
    2.763;
    2.755;
    2.738;
    2.73;
    2.71;
    2.69;
    2.678;
    2.66;
    2.594;
    2.55;
    2.48;
    2.411;
    2.372;
    2.229;
    2.093;
    1.955;
    1.805;
    1.686;
    1.505;
    1.435;
    1.272;
    1.136;
    1.001;
    0.823;
    0.709;
    0.558;
    0.426;
    0.301;
    0.157;
    0.056;
];

h3 = plot(V_commercial, I_commercial, '-m', 'LineWidth', 2);  % plot commercial emulator

% % Real panel data - ME Solar MESM-50W (S = 1000 W/m^2 and T = 25°C)
% V_panel = [
%     0.1345090408816909;
%     3.9418622020801637;
%     7.1102974135229875;
%     10.316096247185497;
%     13.219249737750683;
%     14.493349274149194;
%     15.386339859898216;
%     16.114930504317343;
%     16.794948437178412;
%     17.542220892707384;
%     18.26333881312798;
%     18.943356748216104;
%     19.39172022153349;
%     19.65700194241112;
%     19.90733821529171;
%     20.228665369498877;
%     20.51636526682619;
%     20.882528769478625;
%     21.1702286645789;
%     21.446719472567864;
%     21.71200119344551;
% ];
% 
% I_panel = [
%     3.0107092341738317;
%     2.9969690844678114;
%     2.9832289352435426;
%     2.970297029807906;
%     2.9614063447606873;
%     2.9533239039838524;
%     2.9533239035021017;
%     2.9525156597134687;
%     2.932309557771381;
%     2.880581935547086;
%     2.7868256213795988;
%     2.643766417317217;
%     2.503940189854619;
%     2.3099616083200765;
%     2.122448979503352;
%     1.8508789653549917;
%     1.5663770457709956;
%     1.1840775911493435;
%     0.8163265305040968;
%     0.4598908867537168;
%     0.030713275530074746;
% ];


% Real panel data - Renogy RNG-50DB-H – 50 W (S = 1000 W/m^2 and T = 25°C)
V_panel = [ 
    0.061238999661659355;
    3.0378744826113886;
    6.06593628879359;
    9.019207316748718;
    11.551928051656516;
    12.757528558290698;
    13.855704699997231;
    14.771648303222042;
    15.865224726830606;
    16.729902361354295;
    17.664819810269254;
    18.450378783493765;
    19.100584026063657;
    19.605999152099663;
    20.04147065780234;
    20.416281613412224;
    20.80544927623029;
    21.20426937792104;
    21.462738787922408;
    21.777746419471736;
    22.02257696007481;
    22.272296443566514;
    22.475133634590215;
    22.579352135807298
];
I_panel = [
    2.9194630872527965;
    2.9194630872527965;
    2.915548098563706;
    2.915548098563706;
    2.913870246173136;
    2.9149888143223963;
    2.9077181208521656;
    2.8987695749913653;
    2.879753914787145;
    2.848993288182294;
    2.794742729109542;
    2.7125279639717688;
    2.6045861294008548;
    2.4854586130039786;
    2.342281879231173;
    2.1851230434259357;
    1.9737136465477885;
    1.713087248101959;
    1.4787472036639384;
    1.170022371466326;
    0.8747203580599141;
    0.5447427290262028;
    0.23937360194308832;
    0.012304250975298636
];

% Real panel data - Shell Solar SQ150-PC (S = 1000 W/m^2 and T = 25°C)
% V_panel = [
%     0.07780604683747905;
%     4.2189436898142905;
%     7.660223341663279;
%     10.863995324097095;
%     14.176868703729975;
%     17.155893827390162;
%     20.141363211697026;
%     23.036948208895787;
%     24.995167557029617;
%     26.42690527335035;
%     27.81375668458678;
%     29.001602344647385;
%     30.36284434236471;
%     31.512299834342564;
%     32.59122368036738;
%     33.76659988606946;
%     34.743098058886865;
%     35.65550884640268;
%     36.446045441351224;
%     37.16601846173125;
%     37.82826853208371;
%     38.47780170128618;
%     39.10175339833374;
%     39.68073097512157;
%     40.29205756197019;
%     40.91626468796069;
%     41.54063145321372;
%     42.171478402636254;
%     42.8474591077566;
%     43.38200934569101;
% ];
% 
% I_panel = [
%     4.804197165221235;
%     4.795540075268057;
%     4.798166796403276;
%     4.789358636164255;
%     4.791964661586494;
%     4.79244477341078;
%     4.786709596059194;
%     4.780959931956091;
%     4.775059198186533;
%     4.773217832998629;
%     4.756864468979553;
%     4.734262703388705;
%     4.699256226304568;
%     4.642458468761035;
%     4.56182008609613;
%     4.442863222890885;
%     4.284504230031027;
%     4.096089321638853;
%     3.878645240109937;
%     3.6456489653261293;
%     3.397102567352327;
%     3.1164364242871767;
%     2.809864790583181;
%     2.5115743462965194;
%     2.1490537237230516;
%     1.7761746301469223;
%     1.3618533741500927;
%     0.9319923422019132;
%     0.4524079577975444;
%     0.02045929702601157;
% ];
h4 = plot(V_panel, I_panel, 'ko', ...      % plot real panel data
          'MarkerSize',6, 'MarkerFaceColor','k');
xlabel('Voltage (V)', 'FontSize', 30);
ylabel('Current (A)', 'FontSize', 30);

  xlim([0 24]); 
  ylim([0 3]); 

legend([h1 h2 h3 h4], ...
       {'Open-source PV Emulator – Single Diode Model', 'Open-source PV Emulator – Simplified Exp. Model', 'Commercial PV emulator', 'Real PV panel data'}, ...
       'Location','best');
% Font settings for axis ticks
set(gca, 'FontSize', 30); % Adjusted font size based on your image
% Apply Times New Roman font to all text elements
set(findall(gcf, '-property','FontName'),'FontName','Times New Roman');
set(findall(gca, '-property','FontName'),'FontName','Times New Roman');
hold off; % Release the plot