clear, clc, close all;

%% 1) Display of the three curves + experimental points
figure('Color','w','Position',[100 100 900 500]);
hold on; grid on;

% Single diode emulator - CanadianSolar CS6P-250P (S = 765 W/m^2 and T = 44.5°C)
% V_emulator = [
%     0
%     22.80755;
%     24.17536;
%     25.77529;
%     27.24029;
%     28.71549;
%     29.93957;
%     30.82569;
%     32.12266;
%     33.61550;
%     33.92;
% ];
% 
% I_emulator = [
%     6.79525;
%     6.728934;
%     6.696453;
%     6.513734;
%     6.299920;
%     5.674942;
%     5.156351;
%     4.187371;
%     2.577053;
%     0.723580;
%     0
% ];

% Single diode emulator - CanadianSolar CS6P-250P (S = 556 W/m^2 and T = 33°C)
% V_emulator = [
%     0;
%     15.99633;
%     21.38497;
%     24.11979;
%     25.47998;
%     27.13490;
%     28.61119;
%     30.10375;
%     31.92938;
%     33.62070;
%     34.34491;
%     34.9;
% ];
% 
% I_emulator = [
%     4.93461;
%     4.926764;
%     4.906911;
%     4.890384;
%     4.836957;
%     4.766093;
%     4.515424;
%     4.260068;
%     3.011903;
%     1.829092;
%     0.796171;
%     0;
% ];

% Single diode emulator - Vertex N TSM-NEG21C.20 695W (S = 200 W/m^2 and T = 25°C)
% V_emulator = [
%     0;
%     17.31385;
%     29.14563;
%     33.30596;
%     36.31013;
%     38.27775;
%     40.10532;
%     41.2025;
%     42.82103;
%     44.22889;
%     44.3;
% ];
% 
% I_emulator = [
%     3.66;
%     3.650519;
%     3.634901;
%     3.602349;
%     3.529229;
%     3.277086;
%     3.042891;
%     2.424462;
%     1.360115;
%     0.434306;
%     0;
% ];

% Single diode emulator - Kyocera KC200GT (S = 511 W.m^-2 and T = 54.3 ºC)
V_emulator = [
    0;
    11.90924;
    15.66191;
    18.63553;
    21.14057;
    22.63848;
    23.60215;
    24.54963;
    25.56798;
    26.31991;
    26.9799;
    27.3;
];

I_emulator = [
    4.2;
    4.188322;
    4.172224;
    4.050412;
    3.926395;
    3.60058;
    3.390971;
    2.825413;
    2.187756;
    1.699926;
    0.723199;
    0;
];


h1 = plot(V_emulator,  I_emulator,   '-b',  'LineWidth',2);     % plot single diode emulator

% Real panel data - CanadianSolar CS6P-250P (S = 765 W/m^2 and T = 44.5°C)
% V_pannel = [
%     0.047996217771366645;
%     2.5473136313978317;
%     4.686489351002983;
%     7.605990366562553;
%     10.181947580363017;
%     12.610309040298777;
%     14.79342630980413;
%     17.20541669131795;
%     19.415489834424953;
%     21.816632013769198;
%     24.03214755291164;
%     26.237334370932288;
%     28.26322957001055;
%     29.749962170030145;
%     31.046437882063465;
%     31.92801141798128;
%     32.689215781035756;
%     33.25368190774834;
%     33.59447586154349;
%     34.38443600476654
% ];
% 
% I_pannel = [
%     7.007823910286788;
%     7.0079635369891475;
%     7.001379133258391;
%     7.003776871281191;
%     6.93017776227956;
%     6.9347826983712295;
%     6.841049913320265;
%     6.845653933494394;
%     6.8524813120762555;
%     6.83697299652661;
%     6.848269952562965;
%     6.68079538185797;
%     6.2719700120743145;
%     5.5323882664885256;
%     4.567097566839892;
%     3.6531803358379182;
%     2.83534576727134;
%     2.1046510438953376;
%     1.3538320938536454;
%     0.08683712275429656
% ];

% Real panel data - CanadianSolar CS6P-250P (S = 556 W/m^2 and T = 33°C)
% V_pannel = [
%    0.11870949058476832;
%    2.503084084256967;
%    5.175401505238524;
%    7.590304253402278;
%    9.815231816381960;
%    12.187280070347374;
%    14.589991865444773;
%    16.821065673119850;
%    19.028722204632890;
%    21.272139279014567;
%    23.472448005559684;
%    25.672959815744026;
%    28.063920664439690;
%    29.917176441633483;
%    31.601112724298030;
%    32.722065096396480;
%    33.616384803786715;
%    34.327349424005450;
%    34.741398772039830;
%    34.904501246242180;
% ];
% 
% I_pannel = [
%     5.110461288554346;
%     5.100720374022223;
%     5.111095915194137;
%     5.118929111074918;
%     5.121718383239790;
%     5.122016080125351;
%     5.119807586122182;
%     5.120087590427699;
%     4.957212044814572;
%     4.944943397608992;
%     4.962789821397647;
%     4.950515789494053;
%     4.873004614033777;
%     4.546931980897691;
%     3.879472637469006;
%     3.076400466372332;
%     2.250709493400178;
%     1.347184263076274;
%     0.845228194983978;
%     0.290529789361583;
% ];

% Real panel data - Vertex N TSM-NEG21C.20 695W (S = 200 W/m^2 and T = 25°C)
% V_pannel = [
%     0.1678434272937226;
%     11.881505398286059;
%     21.84139593054212;
%     30.59106007474319;
%     32.82379452408424;
%     34.409356713680666;
%     35.80070202204716;
%     37.25010394119584;
%     38.802810258880186;
%     40.52990158892085;
%     41.98494132703763;
%     43.20681319645658;
%     44.42799243893412;
% ];
% 
% I_pannel = [
%     3.7614442519958295;
%     3.7416365768801825;
%     3.75077704947266;
%     3.7431918186802555;
%     3.7516899697427064;
%     3.7559780448805142;
%     3.7186872164953826;
%     3.5650254880092547;
%     3.261746410383875;
%     2.7423554790956217;
%     2.0733159969994333;
%     1.2878814066106905;
%     0.07435033405284486;
% ];

% Single diode emulator - Kyocera KC200GT (S = 511 W.m^-2 and T = 54.3 ºC)
V_pannel = [
    0.06633956327079193;
    2.7458921458044943;
    4.750187578542191;
    6.738397879641979;
    8.55510640498975;
    10.398634093999334;
    12.247397477176047;
    14.085538251089517;
    15.92895053464986;
    17.767131103542148;
    19.471307382584936;
    21.31996331611866;
    22.868301124243413;
    24.28771513306349;
    25.433614258948253;
    26.2901123451705;
    26.830422064051454;
    27.41886779290256;
    27.846553737021324;
    28.24767918166411;
];

I_pannel = [
    4.14356789750856;
    4.1571047845181806;
    4.161687801527659;
    4.161814349519464;
    4.155246813078904;
    4.162047320620259;
    4.099788754649053;
    4.090994861739706;
    4.0331914003872384;
    4.046674736070509;
    4.044555482254624;
    3.922148395763573;
    3.6816528875172967;
    3.2696145187726584;
    2.7439448794896295;
    2.2115736529084318;
    1.6769545779212427;
    1.0888732202257323;
    0.5074647987806244;
    0.05749032916413199;
];

h2 = plot(V_pannel, I_pannel, 'ko', ...      % plot real panel data
          'MarkerSize',6, 'MarkerFaceColor','k');

xlabel('Voltage (V)', 'FontSize', 30);
ylabel('Current (A)', 'FontSize', 30); 

% Axis limits to match the provided figure
% xlim([0 36]);
% ylim([0 5.5]);

legend([h1 h2], ...
       {'PV Emulator – Single Diode Model', 'Experimental Results – Real PV Panel'}, ...
       'Location','best');

% Axis ticks font configuration
set(gca, 'FontSize', 30); % Adjusted font size based on your image

% Apply Times New Roman font to all text elements
set(findall(gcf, '-property','FontName'),'FontName','Times New Roman');
set(findall(gca, '-property','FontName'),'FontName','Times New Roman');
